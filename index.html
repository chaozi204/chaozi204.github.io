
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title></title>
  <meta name="author" content="超子">

  
  <meta name="description" content="分享">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://chaozi204.github.io">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/bootstrap/bootstrap.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/bootstrap/responsive.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/syntax/syntax.css" media="screen, projection" rel="stylesheet" type="text/css">
  <style type="text/css">
    body {
      padding-bottom: 40px;
    }
    h1 {
      margin-bottom: 15px;
    }
    img {
      max-width: 100%;
    }
    .sharing, .meta, .pager {
      margin: 20px 0px 20px 0px;
    }
    .page-footer p {
      text-align: center;
    }
  </style>
  <script src="/javascripts/libs/jquery.js"></script>
  <script src="/javascripts/libs/modernizr-2.0.js"></script>
  <script src="/javascripts/libs/bootstrap.js"></script>
  <script src="/javascripts/bootstrap.min.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="" type="application/atom+xml">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

  

</head>

<body   >
  <nav role="navigation"><div class="navbar navbar-inverse">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>

      <a class="brand" href="/"></a>

      <div class="nav-collapse">
        <script src="js/bootstrap.min.js"></script>
<link href="stylesheets/bootstrap.min.css" rel="stylesheet" media="screen">
<ul class="nav">
  <li><a href="/"><i class="fa fa-home fa-lg"></i>首页</a></li>
  <li><a href="/blog/archives"><i class="fa fa-bars fa-lg"></i>文章列表</a></li>
  <li class="dropdown">
      <a class="dropdown-toggle" data-toggle="dropdown" ><i class="fa fa-archive fa-lg"></i>文章分类</a>
      <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
          <li>    <li class='category'><a href='/blog/categories/hadoop/'>hadoop (3)</a></li>
<li class='category'><a href='/blog/categories/hive/'>hive (3)</a></li>
<li class='category'><a href='/blog/categories/intellij/'>intellij (1)</a></li>
<li class='category'><a href='/blog/categories/java/'>java (2)</a></li>
<li class='category'><a href='/blog/categories/log4j/'>log4j (1)</a></li>
<li class='category'><a href='/blog/categories/shell/'>shell (1)</a></li>
 </li>
      </ul>
  </li>

  <li><a href="/about"><i class="fa fa-user-md fa-lg"></i>About Me</a></li>
</ul>


        <ul class="nav pull-right" data-subscription="rss">
          <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
          
        </ul>

        
          <form class="pull-right navbar-search" action="https://www.google.com/search" method="get">
            <fieldset role="search">
              <input type="hidden" name="q" value="site:chaozi204.github.io" />
              <input class="search-query" type="text" name="q" results="0" placeholder="Search"/>
            </fieldset>
          </form>
        
      </div>
    </div>
  </div>
</div>
</nav>
  <div class="container" style="width: 1000px">
    <!--div class="row-fluid"-->
    <div>
      <div class="span9 fengchao">
  
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/dynamically-set-logger-level/">在线设置 Log4j 日志级别</a></h1>
    
    
      <p class="meta">
        




2016-02-08
        
  

<span class="byline author vcard">Posted by <span class="fn">超子</span></span>


        
      </p>
    
  </header>


  <div class="entry-content"><ul id="markdown-toc">
  <li><a href="#log4j-" id="markdown-toc-log4j-">在线设置Log4j 日志级别</a></li>
  <li><a href="#log4j--1" id="markdown-toc-log4j--1">log4j 配置属性</a></li>
</ul>

<h4 id="log4j-">在线设置Log4j 日志级别</h4>
<p>hadoop RM,NN,DN,NM等支持动态在线设置log4j的日志级别，参考：<a href="https://hadoop.apache.org/docs/r2.7.2/hadoop-project-dist/hadoop-common/CommandsManual.html#daemonlog">daemonlog</a></p>

<p>改功能的原理是，利用log4j的Logger API中setLevel方法，在线修改当前Logger使用的日志级别。然而，这种方式并不适用所有的log4j的实现，它只能适用于Logger类中对外开放setLevel方法的，目前知道的两个logger的实现带有这个方法：
</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/dynamically-set-logger-level/">阅读全文 &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/hadoop-v2-snappy-install/">Hadoop V2 Snappy 安装及部署</a></h1>
    
    
      <p class="meta">
        




2015-11-10
        
  

<span class="byline author vcard">Posted by <span class="fn">超子</span></span>


        
      </p>
    
  </header>


  <div class="entry-content"><ul id="markdown-toc">
  <li><a href="#hadoop" id="markdown-toc-hadoop">2 重新编译hadoop</a></li>
  <li><a href="#section" id="markdown-toc-section">3 部署</a></li>
  <li><a href="#section-1" id="markdown-toc-section-1">4 解疑答惑</a></li>
</ul>

<blockquote>
  <p>最近同事有需求要使用在hadoop 2.5.1的集群上使用snappy压缩。因为之前没有使用过snappy，所以没有在现有的集群上配置相关信息，于是乎就在官方和google查了一下相关的配置信息。之所以写这篇文章，主要是因为网上发的文章（尤其是中国的某些网站）的内容不靠谱，没有仔细阅读文档，就随便写一些不经过实践的文章来忽悠大家，导致大家如果根据他们的方式来安装和使用，可能会导致莫名其妙的问题。闲话不说了，写下我的操作过程
</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/hadoop-v2-snappy-install/">阅读全文 &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/hive-udf-deploy/">Hive Udf 部署方式小结</a></h1>
    
    
      <p class="meta">
        




2015-11-06
        
  

<span class="byline author vcard">Posted by <span class="fn">超子</span></span>


        
      </p>
    
  </header>


  <div class="entry-content"><h3 id="hive-hook-">Hive Hook 部署方式：</h3>
<pre><code>本方式为我根据hive的hook的特性开发一种部署方式，优点是针对单个客户端，
无需修改HIVE的源码，纯外接的方式来完成udf的部署，比临时udfs方便快捷且永久，且容易管理。
每个组或每个团队之间的udf彼此不受影响。
相信安装部署见：https://github.com/chaozi204/hive-udf-hook
</code></pre>

<p></div>
  
  
    <footer>
      <a rel="full-article" href="/blog/hive-udf-deploy/">阅读全文 &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/log-aggregation-permission-warning/">Yarn 日志聚集权限警告</a></h1>
    
    
      <p class="meta">
        




2015-08-24
        
  

<span class="byline author vcard">Posted by <span class="fn">超子</span></span>


        
      </p>
    
  </header>


  <div class="entry-content"><h3 id="section">问题描述</h3>
<p>集群中所有的nodemanager节点机器总是会报出警告信息
&gt; 警告信息：
2015-07-29 00:44:57,785 WARN org.apache.hadoop.yarn.server.nodemanager.containermanager.logaggregation.LogAggregationService: Remote Root Log Dir [/yarn-logs] already exist, but with incorrect permissions. Expected: [rwxrwxrwt], Found: [rwxr-xr-x]. The cluster may have problems with multiple users.</p>

<p>从警告的内容来看，似乎是目录的权限不匹配导致的，为了防止这个警告产生对集群的影响，于是排查本异常产生的原因。
</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/log-aggregation-permission-warning/">阅读全文 &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/bash-tips/">Shell 技巧</a></h1>
    
    
      <p class="meta">
        




2015-01-09
        
  

<span class="byline author vcard">Posted by <span class="fn">超子</span></span>


        
      </p>
    
  </header>


  <div class="entry-content"><p>记录工作中常用且常忘的那些方法</p>

<blockquote>
  <p>bash中取由变量生成的变量的值</p>
</blockquote>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">var1</span><span class="o">=</span><span class="s2">&quot;123&quot;</span>
</span><span class="line"><span class="nv">var2</span><span class="o">=</span>1
</span><span class="line"><span class="nv">gen_var</span><span class="o">=</span>sql<span class="nv">$var2</span>
</span><span class="line"><span class="nb">echo</span> <span class="k">$((</span>gen_var<span class="k">))</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<blockquote>
  <p>bash中取脚本的当前路径</p>
</blockquote>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">dir</span><span class="o">=</span><span class="k">$(</span><span class="nb">cd</span> <span class="sb">`</span>dirname <span class="nv">$0</span><span class="sb">`</span><span class="p">;</span><span class="nb">pwd</span><span class="k">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/rcfile-assistant-compression/">利用RCFile的特性提高压缩率</a></h1>
    
    
      <p class="meta">
        




2015-01-09
        
  

<span class="byline author vcard">Posted by <span class="fn">超子</span></span>


        
      </p>
    
  </header>


  <div class="entry-content"><pre><code>最近公司集群的存储空间过于紧张，一度低于5% 。集群空间一下子成为了集群瓶颈。再申请扩容无望的情况下，我们不得不着手于通过业务节省空间，
或者强制进行删除文件。
工作中,和同事无意中发现他的一份业务数据采用lzo + rcfile压缩后，压缩率超高，压缩前3G，压缩后200M。这种压缩率让我们感觉到异常(因为
通常情况下,这种压缩率级别在3倍左右),通过排查发现造成这种高压缩率的原因为:
1. 日记记录特别相似性（这是业务本身的特性）,很多行除了小部分字段不同外,大部分一样.
2. 利用distribute by + sort by的hive特性，生成了hive表结果数据. 这样可以将相似的记录放在同一个reduce中，并根据特性字段排序
3. 利用rcfile的行列混合存储特性，就可以完成非常高的压缩率了(因为大部分列相同,所有就会有很高的压缩比)
</code></pre>

</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/date-calendar-of-java/">Date与Calendar对于周信息表示的差异</a></h1>
    
    
      <p class="meta">
        




2014-12-19
        
  

<span class="byline author vcard">Posted by <span class="fn">超子</span></span>


        
      </p>
    
  </header>


  <div class="entry-content"><blockquote>
  <p>最近在做一个项目中，同时使用了Java自身携带的java.util.Date类，和java.util.Calendar类来表示和处理时间。项目期间遇见了一个时间上的bug，主要是表示周几的问题上出现了差异。因为Java中，Date类的getDay方法，和Calendar.get(Calendar.DAY_OF_WEEK)返回的周信息表示分别为:</p>
</blockquote>

<ul>
  <li>Date： 周日(0),周一(1),周二(2),周三(3),周四(4),周五(5),周六(6)</li>
  <li>Calendar： 周日(1),周一(2),周二(3),周三(4),周四(5),周五(6),周六(7)
</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/date-calendar-of-java/">阅读全文 &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/log4j-stack/">Log4j 打印异常堆栈信息</a></h1>
    
    
      <p class="meta">
        




2014-12-09
        
  

<span class="byline author vcard">Posted by <span class="fn">超子</span></span>


        
      </p>
    
  </header>


  <div class="entry-content"><p>常用 Log4j 打印日志的代码：</p>

<p></div>
  
  
    <footer>
      <a rel="full-article" href="/blog/log4j-stack/">阅读全文 &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/hive-chinese/">Hive正则匹配中文问题</a></h1>
    
    
      <p class="meta">
        




2014-11-29
        
  

<span class="byline author vcard">Posted by <span class="fn">超子</span></span>


        
      </p>
    
  </header>


  <div class="entry-content"><p>利用Hive的正则匹配中文时需要注意：</p>

<ul>
  <li>中文的字符集合为[\u4e00-\u9fa5]</li>
  <li>但是hive在hive执行中会被转义，因此需要增加一次java的转义字符才能够正确使用</li>
</ul>

<p>例如：
<code>select title from vid_title where type='my' and title rlike '^[\\\u4e00-\\\u9fa5]{1,2}$' </code></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/intellij-abbreviation/">Intellij Idea 自定义缩写</a></h1>
    
    
      <p class="meta">
        




2014-11-28
        
  

<span class="byline author vcard">Posted by <span class="fn">超子</span></span>


        
      </p>
    
  </header>


  <div class="entry-content"><p>缩写是开发中利器，能够节约工程师打太多重复的代码好工具，作为一款比较牛叉的开发工具，Intellij当然包含了这个功能，而且还非常丰富，下面就记录如何查找默认定义的这些缩写，以及如何自定义缩写。 说明环境: Intellij IDEA 13 
</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/intellij-abbreviation/">阅读全文 &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/confession/">Task读取HDFS数据导致任务失败或延迟</a></h1>
    
    
      <p class="meta">
        




2014-11-25
        
  

<span class="byline author vcard">Posted by <span class="fn">超子</span></span>


        
      </p>
    
  </header>


  <div class="entry-content"><h3 id="section">问题描述</h3>
<ul>
  <li>
    <p>Hadoop Job在执行时非常缓慢（hadoop-1.0.0 和 hadoop-2.5.0集群中都有），且很多Map任务或reduce任务因为超时被kill掉，异常信息如下：
<code>Task attempt_201406261559_894052_m_000269_1 failed to report status for 602 seconds. Killing!</code></p>
  </li>
  <li>任务卡在初始化的过程中，也就是Map和Reduce的setup方法中
<code>protected void setup(Context context ) throws IOException, InterruptedException { }
</code></li>
  <li>任务有些成功有些被kill，大部分情况下job最终执行是成功，只是比较耗时
</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/confession/">阅读全文 &rarr;</a>
    </footer>
  


    </article>
  
  <ul class="pager">
    
    <li><a href="/blog/archives">Blog Archives</a></li>
    
  </ul>
</div>
<aside class="sidebar-nav span3">
  
    
  
</aside>

    </div>
  </div>
  <footer role="contentinfo" class="page-footer"><hr>

<p>
  Copyright &copy; 2016 - 超子 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
  <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1256430882'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s11.cnzz.com/z_stat.php%3Fid%3D1256430882' type='text/javascript'%3E%3C/script%3E"));</script>
</p>


</footer>
  











</body>
</html>
